\chapter{Общие положения}\label{COMMON}

\section{Назначение}

КТ представляет владельца при его взаимодействии с ПС.
На токене хранятся идентификационные данные владельца, ключи, сертификаты, 
другие объекты (см. разделы~\ref{OBJ}, \ref{DATA}, \ref{CERTS}). 
%
Токен реализует криптографические алгоритмы и протоколы (см. раздел~\ref{CRYPTO}), 
с помощью которых владелец защищает доступ к своим объектам, 
доказывает свою подлинность перед другими сторонами, 
проверяет подлинность других сторон, генерирует личные ключи, подписывает 
данные, снимает защиту с ключей шифрования данных, выполняет другие 
криптографические операции.
%
Связанные операции и объекты КТ оформляются в виде прикладных программ,
которые сами являются объектами КТ. Обязательными являются 
программы eID и eSign (см.~\ref{OBJ.eID}, \ref{OBJ.eSign}).

\if0
Могут устанавливаться дополнительные программы, например, ePassport~--- 
электронный паспорт. Дополнительные программы в настоящем стандарте не 
рассматриваются.
\fi

Важно, что операции с личным ключом (выработка ЭЦП, снятие защиты) выполняются  
в пределах защищенной криптографической границы КТ после предъявления 
корректного пароля. Личный ключ не покидает пределов границы, при аппаратной 
защите границы секретность ключа сохраняется даже при эксплуатации КТ в 
агрессивной среде.

КТ используется в двух режимах~--- базовом и терминальном.
%
В базовом режиме владелец настраивает КТ и выполняет с его помощью 
локальные (не требующие онлайн-взаимодействия с другими сторонами) 
криптографические операции. Взаимодействие с КТ поддерживает КП. 
%
В терминальном режиме КТ взаимодействует с ПС онлайн. Представителями систем 
при этом являются терминалы, взаимодействие со стороны владельца снова 
поддерживает КП.

В терминальном режиме КТ обеспечивает решение следующих задач: 
\begin{enumerate}
\item[1)]
аутентификация владельца на доступ к ресурсам и сервисам токена; 
\item[2)]
управление объектами, размещенными в пределах криптографической границы токена;
\item[3)]
аутентификация терминала и аутентификация перед ним;
\item[4)]
установка защищенного соединения с терминалом;
\item[5)]
проверка полномочий терминала и передача ему идентификационных данных владельца;
\item[6)]
проверка полномочий терминала и открытие ему доступа к прикладным программам КТ. 
\end{enumerate}

Получив доступ к прикладной программе КТ, терминал может выполнять примерно те 
же криптографические операции, что и владелец в базовом режиме. Однако в 
базовом режиме, несмотря на защиту личного ключа, сохраняется угроза подмены 
обрабатываемых (например, подписываемых) на нем данных. Для сравнения: в 
терминальном режиме КТ получает данные от терминала, предварительно прошедшего 
аутентификацию перед токеном. Данные передаются по защищенному соединению, и их 
невозможно раскрыть или подменить даже при полном контроле среды эксплуатации 
токена. Таким образом, терминальный режим обеспечивает большие гарантии 
безопасности при условии, что среда эксплуатации терминала защищена.

Терминал может представлять не непосредственно ПС, с которой взаимодействует 
владелец КТ, а специализированную СИ. Эта служба оказывает одной или 
нескольким ПС услугу аутентификации с одновременным предоставлением 
идентификационных данных.
%
СИ по запросу ПС проводит аутентификацию на уровне 
<<терминал СИ~--- КТ>> и, в случае успеха, выпускает билет аутентификации. В 
этом билете приводятся утверждения о владельце и об аутентификации. 
Схема выпуска билета аутентификации определена в разделе~\ref{FLOW}.

\section{Исполнение} 

КТ может быть выполнен в виде смарт-карты, USB-токена 
или программы, которая работает на защищенном сервере. 
Программные токены могут быть полезны для организации криптографических 
сервисов информационных систем. 

Настоящий стандарт определяет командный интерфейс взаимодействия с КТ, который
унифицирует работу с токенами различных типов.
%
Перечень допустимых команд интерфейса определяется текущим состоянием КТ.
%
Состояния описаны в разделе~\ref{STATES}, командный интерфейс~--- в 
разделе~\ref{CMDS}.

Программное обеспечение КТ должно соответствовать требованиям СТБ~34.101.27  или
аналогичных ТНПА. На аппаратном КТ должны быть предусмотрены средства инженерной
защиты от злоумышленника, завладевшего токеном. Эти средства должны
препятствовать чтению критических данных (личных ключей, паролей,
идентификационных данных) и переводу КТ в необнаружимое небезопасное состояние.

\section{Терминалы}

Терминалы бывают двух типов~--- локальные и удаленные.

Локальный терминал взаимодействует с КТ непосредственно. КП является 
его частью. Локальный терминал должен быть аппаратным.

Удаленный терминал взаимодействует с КТ через коммуникационные сети,
как правило сети Интернет. Посредником при взаимодействии, 
кроме КП, может быть еще и браузер. 

Для организации взаимодействия с КТ терминалы снабжаются сертификатами
(см. раздел~\ref{CERTS}).

\section{Клиентская программа}

КП, организуя взаимодействие между КТ, владельцем и терминалом,
обрабатывает критические данные (пароли), а также открытые данные, 
целостность и подлинность которых определяют надежность  
взаимодействия.

КП не может самостоятельно 
обеспечить полную защиту обрабатываемых данных. 
Защита организуется также средствами среды эксплуатации, 
в том числе через настройки операционной системы.  
%
Основные задачи защиты средствами среды: 
невозможность чтения критических областей памяти вредоносными программами; 
невозможность подмены открытых данных,
защита канала <<браузер~--- КП>>.
%
Организация защиты выходит за рамки настоящего стандарта.

При работе с аппаратным КТ к уязвимым критическим данным
относятся только пароли доступа к КТ. Поэтому аппаратным КТ следует отдавать 
предпочтение в тех ситуациях, когда КП выполняется в потенциально агрессивной 
среде, например на компьютере, подключенном к сети общего пользования.







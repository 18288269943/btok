\begin{appendix}{Б}{справочное}{Файловая система}
\label{FILES}

\hiddensection{Общие сведения}

В~\cite{APDU} прикладные программы и данные КТ интерпретируются как 
файлы. Имеются файлы двух типов: 

\begin{enumerate}
\item[1)]
DF (dedicated file, выделенный файл). DF предназначен для 
объявления прикладных программ и/или объединения файлов в группы. DF может 
являться родительским для других файлов;

\item[2)]
EF (elementary file, элементарный файл). EF предназначен для 
хранения данных. EF не может быть родительским для других файлов.  
\end{enumerate}

Имеются две категории EF:
\begin{itemize}
\item[--] 
внутренние EF, используемые картой для целей управления и контроля;  
\item[--]
рабочие EF, предназначенные для хранения данных, к которым можно обращаться извне.
\end{itemize}                                                            
                  
При выполнении команд КТ может обращаться к DF и EF как явно, так и неявно 
(автоматически). Для явного обращения используется один из следующих 
методов: 
\begin{enumerate}
\item
Выбор по имени DF. Имя DF может ссылаться на любой DF. Данное имя 
является строкой длины до 16 октетов. Прикладным программам КТ назначаются 
специальные идентификаторы (AID). Такой идентификатор может использоваться 
как имя DF прикладной программы. 

\item
Выбор по идентификатору файла. Идентификатор файла (FID) может 
ссылаться на любой файл. Данный идентификатор состоит из 2 октетов. 
Некоторые из значений зарезервированы. Например, 
значение $\texttt{3F00}_{16}$ зарезервировано для обязательного DF, 
который является корневым в иерархической структуре файлов и 
который обозначают MF (master file, мастерфайл). 

\item
Выбор по пути. Путь может ссылаться на любой файл. Он 
представляет собой объединение идентификаторов файлов. Путь начинается с 
идентификатора приложения (MF для абсолютного пути и текущего DF для 
относительного пути) и заканчивается идентификатором самого файла. Между 
двумя данными идентификаторами путь содержит идентификаторы промежуточных 
DF (если они есть). 

\item
Выбор по короткому идентификатору EF. Короткий идентификатор 
файла (SFID) может ссылаться на любой EF. Данный идентификатор 
представляет собой 5 бит и может принимать значения от 1 до 30. В ISO/IEC 
7816-4 накладываются ограничения на использование данного идентификатора. 
\end{enumerate}

\hiddensection{Прикладная программа eID}

Для прикладной программы eID используется следующий AID: 
$\hex{E806092A700002002265XXXX}$. 
Прикладная программа eID поддерживает 22 группы 
данных (DG1~--- DG22) с атрибутами владельца КТ (см. 6.1). 
Идентификаторы элементарных файлов с группами данных, 
возможные права доступа к ним приводятся в таблице~\ref{Table.FILES.DG}. 
В таблице для прав доступа используются обозначения: R~--- право на чтение, 
W~--- право на запись, R/W~--- право на чтение и запись.
 
\begin{table}[H]
\caption{Группы данных eID}
\label{Table.FILES.DG}
\begin{tabular}{|c|c|c|c|}
\hline
Группа & Содержание & FID & Доступ\\
\hline
\hline
DG1 & Тип КТ & 
$\texttt{0101}_{16}$ & R\\
DG2 & Страна, выпустившая КТ & 
$\texttt{0102}_{16}$ & R\\
DG3 & Дата окончания действия КТ & 
$\texttt{0103}_{16}$ & R\\
DG4 & Имя владельца КТ & 
$\texttt{0104}_{16}$ & R\\
DG5 & Фамилия и отчество владельца КТ & 
$\texttt{0105}_{16}$ & R\\
DG6 & 
%Псевдоним владельца КТ & 
--- & 
$\texttt{0106}_{16}$ & R\\
DG7 & Академическое звание & 
$\texttt{0107}_{16}$ & R\\
DG8 & Дата рождения & 
$\texttt{0108}_{16}$ & R\\
DG9 & Место рождения & 
$\texttt{0109}_{16}$ & R\\
DG10 & Национальность & 
$\texttt{010A}_{16}$ & R\\
DG11 & Пол & 
$\texttt{010B}_{16}$ & R\\
DG12 & Дополнительные данные для чтения & 
$\texttt{010C}_{16}$ & R\\
DG13 & 
%ФИО владельца, данное ему при рождении & 
--- &
$\texttt{010D}_{16}$ & R\\
DG14 & Изображение ручной подписи владельца КТ & 
$\texttt{010E}_{16}$ & R\\
DG15 & Дата выпуска КТ & 
$\texttt{010F}_{16}$ & R\\
DG16 & --- &  $\texttt{0110}_{16}$ & R\\
DG17 & 	Адрес постоянного места жительства & 
$\texttt{0111}_{16}$ & R/W\\
DG18 & 	Код региона & 
$\texttt{0112}_{16}$ & R/W\\
DG19 & 	Вид на жительство I & 
$\texttt{0113}_{16}$ & R/W\\
DG20 & 	Вид на жительство II & 
$\texttt{0114}_{16}$ & R/W\\
DG21 & 	Номер телефона & 
$\texttt{0115}_{16}$ & R/W\\
DG22 & 	Адрес электронной почты & 
$\texttt{0116}_{16}$ & R/W\\
\hline
\end{tabular}
\end{table}

\hiddensection{Прикладная программа eSign}

Прикладной программе eSign назначается следующий AID: 
\doubt{$\hex{E806092A700002002265XXXX}$}. 
%
Прикладная программа eSign поддерживает чтение и обновление 
элементарных файлов, содержащих сертификаты открытых ключей и данные для
запроса на выпуск сертификата (см.~\ref{Oper.Seq.GeKeySetCert}). 
В одном элементарном файле может храниться только один
сертификат. При этом сертификат должен
соответствовать личному ключу, ссылка на который приводится
в таблице~\ref{Table.Oper.KeyRef}.
Идентификаторы указанных элементарных файлов, обязательность
их наличия и права доступа в состояних PS и AS
приводятся в таблице~\ref{Table.FILES.EFSIGN}.
В таблице для прав доступа используются обозначения: 
R~--- право на чтение, W~--- право на запись,
R/W~--- право на чтение и запись.
 
\begin{table}[H]
\caption{Элементарные файлы eSign, доступные для чтения и обновления}
\label{Table.FILES.EFSIGN}
\begin{tabular}{|l|c|c|c|c|}
\hline
Содержание & FID & Наличие & \multicolumn{2}{|c|}{Доступ}\\
\cline{4-5}
& & & PS & AS \\
\hline
\hline
Данные запроса на выпуск сертификата & 
$\texttt{5100}_{16}$ & Необязательно &  R & R/W \\
%\hline
Сертификат ключа со ссылкой $\hex{01}$ & 
$\texttt{5101}_{16}$ & Обязателно & R/W & -- \\
%\hline
Сертификат ключа со ссылкой $\hex{02}$ & 
$\texttt{5102}_{16}$ & Необязательно & R/W & -- \\
%\hline
Сертификат ключа со ссылкой $\hex{03}$ & 
$\texttt{5103}_{16}$ & Необязательно & R/W & -- \\
%\hline
Сертификат ключа со ссылкой $\hex{11}$ & 
$\texttt{5111}_{16}$ & Обязательно & -- & R/W \\
%\hline
Сертификат ключа со ссылкой $\hex{12}$ & 
$\texttt{5112}_{16}$ & Необязательно &  -- & R/W \\
%\hline
Сертификат ключа со ссылкой $\hex{13}$ & 
$\texttt{5113}_{16}$ & Необязательно & -- & R/W \\
\hline
\end{tabular}
\end{table}

\mbox{}
\vfill
\mbox{}
\clearpage


\end{appendix}